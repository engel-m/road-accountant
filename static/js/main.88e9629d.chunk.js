(this["webpackJsonproad-accountant"]=this["webpackJsonproad-accountant"]||[]).push([[0],{13:function(e,t,a){e.exports=a(28)},18:function(e,t,a){},19:function(e,t,a){},20:function(e,t,a){},21:function(e,t,a){},28:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),l=a(12),o=a.n(l),c=(a(18),a(19),a(20),a(21),a(1)),s=a(6),i=function(e,t){var a=Object(s.a)({},e);switch(t.type){case"SET_VIEW":var r=t.payload.viewName;return a.renderStatus.currentView=r,a;case"SET_MODAL":var n=t.payload.modalName;return a.renderStatus.modalView=n,a;default:return e}},m={renderStatus:{currentView:"Landing",modalView:!1}},d=Object(r.createContext)(m),u=function(e){var t=e.children,a=Object(r.useReducer)(i,m),l=Object(c.a)(a,2),o=l[0],s=l[1];return n.a.createElement(d.Provider,{value:{renderStatus:o.renderStatus,currentGroup:o.currentGroup,setView:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";""!==t&&t.preventDefault(),s({type:"SET_VIEW",payload:{viewName:e}})},setModal:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";""!==t&&t.preventDefault(),s({type:"SET_MODAL",payload:{modalName:e}})}}},t)},p=a(4),f=a.n(p);a(22),a(24);f.a.initializeApp({apiKey:"AIzaSyAdQ3TbFouDoAd8sKXDoanU9C7Id5UwQuw",authDomain:"road-accountant.firebaseapp.com",databaseURL:"https://road-accountant.firebaseio.com",projectId:"road-accountant",storageBucket:"road-accountant.appspot.com",messagingSenderId:"489628926362",appId:"1:489628926362:web:44c9e87d9bd3d854cc7a23"});var b=f.a.auth(),g=new f.a.auth.GoogleAuthProvider,x=f.a.firestore(),h=f.a.firestore.Timestamp,w=f.a.firestore.FieldValue,v=function(){return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"animated fadeIn h-screen mx-auto flex content-center justify-center"},n.a.createElement("span",{className:"text-indigo-600 opacity-75 mx-auto block self-center -mt-24"},n.a.createElement("i",{className:"fas fa-circle-notch fa-spin fa-5x"}))))},E=n.a.createContext(),y=function(e){var t=e.children,a=Object(r.useState)(b.currentUser),l=Object(c.a)(a,2),o=l[0],s=l[1],i=Object(r.useState)(null),m=Object(c.a)(i,2),d=m[0],u=m[1],p=Object(r.useState)(!0),f=Object(c.a)(p,2),g=f[0],h=f[1],w=Object(r.useState)(!1),y=Object(c.a)(w,2),N=y[0],j=y[1],k=Object(r.useRef)(null),O=Object(r.useRef)(null);return Object(r.useEffect)((function(){return b.onAuthStateChanged((function(e){e?e&&(k.current=x.collection("Users").doc(e.uid).onSnapshot((function(e){var t=e.data();"undefined"!==typeof t&&null!==t&&(t.demo?j(!0):j(!1)),s(e.data()),console.log("Updated user data from new snapshot")}),(function(e){console.log(e)})),O.current=x.collection("Notifications").doc(e.uid).onSnapshot((function(e){u(e.data()),console.log("Updated notifications from new snapshot")}),(function(e){console.log(e)})),console.log("Listening to user data and notifications"),h(!1)):(s(null),u(null),k.current&&k.current(),k.current=null,O.current&&O.current(),O.current=null,h(!1))})),function(){console.log("Returned Auth / Notifications Listener useEffect, unsubscribing"),k.current&&k.current(),k.current=null,O.current&&O.current(),O.current=null}}),[]),g?n.a.createElement(v,null):n.a.createElement(E.Provider,{value:{authUser:o,demo:N,unsubscribeUser:k,notifications:d,unsubNotifications:O}},t)},N=n.a.createContext(),j=function(e){var t=e.children,a=Object(r.useContext)(E).authUser,l=Object(r.useContext)(d).setView,o=Object(r.useState)(null),s=Object(c.a)(o,2),i=s[0],m=s[1],u=Object(r.useState)(!0),p=Object(c.a)(u,2),f=p[0],b=p[1],g=Object(r.useRef)(null);return Object(r.useEffect)((function(){return a||(m(null),g.current&&g.current(),g.current=null,b(!1)),a&&(a.selectedGroup?(g.current&&g.current(),g.current=x.collection("Groups").doc(a.selectedGroup).onSnapshot((function(e){m(e.data()),console.log("Updated currentGroup state from new snapshot")}),(function(e){console.log(e)})),console.log("New group listener started, groupId: "+a.selectedGroup),l("MainAppView")):(m(null),l("GroupSelect")),b(!1)),function(){console.log("Returned Grouplistener useEffect, unsubscribing"),g.current&&g.current(),g.current=null}}),[a]),f?n.a.createElement(v,null):n.a.createElement(N.Provider,{value:{currentGroup:i,pendingGroup:f,unsubscribeGroup:g}},t)},k=function(e){var t=Object(r.useContext)(d),a=t.setView,l=t.setModal;return n.a.createElement(n.a.Fragment,null,n.a.createElement("span",{onClick:function(t){return function(e,t,r){"Modal"===e&&l(t,r),"View"===e&&a(t,r)}(e.linkType,e.linkTo,t)},className:"block cursor-pointer lg:inline-block text-md font-bold text-purple-900 sm:hover:border-indigo-400  hover:text-orange-500 mx-2 \r focus:text-blue-500 p-1 hover:bg-gray-300 sm:hover:bg-transparent rounded-lg"},e.linkText))},O=function(){var e=Object(r.useContext)(d).setView,t=Object(r.useContext)(E),a=t.authUser,l=t.unsubscribeUser,o=t.unsubNotifications,c=Object(r.useContext)(N).unsubscribeGroup;return n.a.createElement(n.a.Fragment,null,n.a.createElement("span",{onClick:function(){a?(l.current&&(l.current(),l.current=null),c.current&&(c.current(),c.current=null),o.current&&(o.current(),o.current=null),b.signOut().then((function(){e("Landing")})).catch((function(e){console.log("Error Logging Out:"+e)}))):e("Landing")},className:"cursor-pointer lg:inline-block text-md font-bold  text-purple-900  sm:hover:border-indigo-400  hover:text-orange-500 mx-2 \r focus:text-blue-500  p-1 hover:bg-gray-300 sm:hover:bg-transparent rounded-lg"},a?"LOG OUT":"LOG IN"))},C=function(){var e=Object(r.useContext)(d).setModal,t=Object(r.useContext)(E).notifications,a=t?t.invites:null,l=a?Object.keys(a).length:null;return n.a.createElement(n.a.Fragment,null,l?n.a.createElement("span",{onClick:function(t){return e("NotificationsModal",t)},className:"cursor-pointer lg:inline-block text-sm font-bold bg-green-500 text-white sm:hover:border-indigo-400 mx-2 \r p-1 hover:bg-green-600 hover:shadow-lg rounded-lg"},l,"  NEW INVITES!"):null)},S=function(){var e=Object(r.useContext)(d),t=e.renderStatus,a=e.setView,l=Object(r.useContext)(E).authUser,o=t.currentView,s=Object(r.useState)(!1),i=Object(c.a)(s,2),m=i[0],u=i[1];return n.a.createElement("header",null,n.a.createElement("div",{className:"py-3 px-2 lg:mx-4 xl:mx-12"},n.a.createElement("div",{className:""},n.a.createElement("nav",{className:"border-b flex items-center justify-between flex-wrap pb-4"},n.a.createElement("div",{className:"flex items-center flex-no-shrink text-white mr-6 "},n.a.createElement("img",{onClick:l?function(e){a("MainAppView",e)}:function(e){a("Landing",e)},className:"h-12 w-12 ml-2 mr-2 cursor-pointer",width:"64",height:"64",viewBox:"0 0 64 64",src:"img/road-icon.svg",alt:"Road Accountant Logo"}),n.a.createElement("span",{onClick:l?function(e){a("MainAppView",e)}:function(e){a("Landing",e)},className:"text-2xl font-extrabold text-purple-900 mt-2 hover:text-blue-700 font-black cursor-pointer"},"Road Accountant"),n.a.createElement("span",{className:"hidden md:inline-block ml-12 text-sm font-extrabold text-green-700 mt-2 hover:text-green-600 font-black cursor-pointer"},l?"Logged in as "+l.email:"")),n.a.createElement("div",{className:"block lg:hidden",onClick:function(e){e.preventDefault(),u(!m)}},n.a.createElement("button",{className:"navbar-burger flex items-center px-3 py-2 border rounded text-white border-white hover:text-white hover:border-white"},n.a.createElement("svg",{className:"fill-current h-6 w-6 text-gray-700",viewBox:"0 0 20 20",xmlns:"http://www.w3.org/2000/svg"},n.a.createElement("title",null,"Menu"),n.a.createElement("path",{d:"M0 3h20v2H0V3zm0 6h20v2H0V9zm0 6h20v2H0v-2z"})))),n.a.createElement("div",{id:"main-nav",className:"w-full text-right flex-grow lg:flex items-center lg:w-auto mt-4 md:mt-2 "+(m?"":"hidden")+" "},n.a.createElement("div",{className:"text-xl lg:text-base lg:flex-grow mt-2 animated jackinthebox xl:mx-8"},l&&n.a.createElement("span",{className:"md:hidden block ml-12 text-sm font-extrabold text-green-700 mt-2 hover:text-green-600 font-black cursor-pointer"},"Logged in as ",l.email),l&&n.a.createElement(C,null),l&&n.a.createElement(k,{linkText:"+ CREATE GROUP",linkType:"Modal",linkTo:"CreateGroupModal"}),l&&n.a.createElement(k,{linkText:">MY GROUPS",linkType:"View",linkTo:"GroupSelect"===o&&l.selectedGroup?"MainAppView":"GroupSelect"}),!l&&n.a.createElement(k,{linkText:"CREATE ACCOUNT",linkType:"View",linkTo:"CreateAccount"}),n.a.createElement(O,null)))))))},I=a(3),D=function(){var e="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",t=0,a=[];return function(){var r=(new Date).getTime(),n=r===t;t=r;for(var l=new Array(8),o=7;o>=0;o--)l[o]=e.charAt(r%64),r=Math.floor(r/64);if(0!==r)throw new Error("We should have converted the entire timestamp.");var c=l.join("");if(n){for(o=11;o>=0&&63===a[o];o--)a[o]=0;a[o]++}else for(o=0;o<12;o++)a[o]=Math.floor(64*Math.random());for(o=0;o<12;o++)c+=e.charAt(a[o]);if(20!==c.length)throw new Error("Length should be 20.");return c}}(),M=["black","gray-600","gray-700","gray-800","gray-900","red-400","red-500","red-600","red-700","red-800","orange-400","orange-500","orange-600","orange-700","orange-800","yellow-400","yellow-500","yellow-600","yellow-700","yellow-800","green-700","green-800","teal-400","teal-500","teal-600","teal-700","teal-800","blue-300","blue-500","blue-600","blue-700","blue-800","indigo-300","indigo-400","indigo-500","indigo-600","indigo-700","indigo-800","indigo-900","purple-300","purple-400","purple-500","purple-600","purple-700","purple-800","pink-300","pink-400","pink-500","pink-600","pink-700","pink-800"],A=function(e){var t=e.setModal,a=Object(r.useContext)(N).currentGroup,l=Object(r.useState)(""),o=Object(c.a)(l,2),s=o[0],i=o[1];return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"modal-content py-4 text-center px-6"},n.a.createElement("div",{className:"flex justify-between items-center pb-3"},n.a.createElement("p",{className:"text-2xl text-indigo-700 font-bold"},"ADD GROUP MEMBER"),n.a.createElement("div",{onClick:function(e){return t(!1,e)},className:"modal-close cursor-pointer z-50"},n.a.createElement("p",{className:"font-black text-gray-700"},"X"))),n.a.createElement("p",{className:"text-lg mt-2 text-gray-800"},"Add a person in your group that you will manage expenses for:"),n.a.createElement("form",{id:"name-form"},n.a.createElement("div",{className:"relative w-full mb-3"},n.a.createElement("label",{className:"block uppercase text-gray-700 text-xs font-bold mb-2",htmlFor:"nickname"},"Nickname ",n.a.createElement("span",{className:"text-gray-700 normal-case italic opacity-50"})),n.a.createElement("input",{type:"nickname",id:"nickname",maxLength:"12",required:!0,className:"px-3 py-3 placeholder-gray-400 text-gray-700 bg-white rounded text-sm shadow focus:outline-none focus:shadow-outline w-full",placeholder:"Nickname"})),n.a.createElement("div",{className:"text-center mt-6"},n.a.createElement("button",{className:"modal-close px-4 bg-indigo-600 p-3 rounded-lg text-white hover:bg-indigo-400",type:"submit",onClick:function(e){e.preventDefault();var r=document.querySelector("#name-form").nickname.value,n=D(),l=M[Math.floor(Math.random()*M.length)];i(null),a&&x.collection("Groups").doc(a.groupId).set({groupMembers:Object(I.a)({},n,{color:l,displayName:r,email:"User not registered",role:"npc"})},{merge:!0}).then(!s&&t(!1)).catch((function(e){i(e.message)}))}},"Add to Group"))),n.a.createElement("div",{className:"w-full rounded-lg bg-gray-300 mt-6 mb-5"},n.a.createElement("p",{className:"text-2xl text-indigo-700 font-bold"},"OR")),n.a.createElement("p",{className:"text-lg text-gray-800"},"Invite a user to see and use this group, by the e-mail they registered with:"),n.a.createElement("form",{id:"email-form",className:"mt-4"},n.a.createElement("div",{className:"relative w-full mb-3"},n.a.createElement("label",{className:"block uppercase text-gray-700 text-xs font-bold mb-2",htmlFor:"email"},"User E-mail ",n.a.createElement("span",{className:"text-gray-700 normal-case italic opacity-50"})),n.a.createElement("input",{type:"email",id:"email",required:!0,className:"px-3 py-3 placeholder-gray-400 text-gray-700 bg-white rounded text-sm shadow focus:outline-none focus:shadow-outline w-full",placeholder:"E-mail"})),n.a.createElement("div",{className:"text-center mt-6 mb-5"},n.a.createElement("button",{className:"modal-close px-4 bg-indigo-600 p-3 rounded-lg text-white hover:bg-indigo-400",type:"submit",onClick:function(e){e.preventDefault();var r=document.querySelector("#email-form").email.value,n=M[Math.floor(Math.random()*M.length)],l=null,o=null;a&&x.collection("Notifications").where("email","==",r).get().then((function(e){e.empty?i("No user found with email "+r):e.forEach((function(e){l=e.id,o=e.data().displayName;var c="undefined"!==typeof a.groupMembers[l];if(c)throw new Error("User is already in group!");!c&&x.collection("Groups").doc(a.groupId).set({groupMembers:Object(I.a)({},l,{color:n,displayName:o,email:r,role:"member"})},{merge:!0}).then(x.collection("Notifications").doc(l).set({invites:Object(I.a)({},a.groupId,{groupName:a.name,creatorName:a.creator.name,creatorMail:a.creator.email,creatorId:a.creator.id,createDate:a.createDate,groupId:a.groupId,inviteDate:h.fromDate(new Date).toDate()})},{merge:!0})).then(""===s&&t(!1)).catch((function(e){console.log(e),i(e.message)}))}))})).catch((function(e){console.log(e),i(e.message)}))}},"Invite to Group"))),""!==s&&n.a.createElement("div",{className:"bg-red-100 p-3 border-red-600 border rounded"},n.a.createElement("p",{className:"text-red-600 text-center"},s))))},G=function(e){var t=Object(r.useContext)(E).demo,a=Object(r.useState)(""),l=Object(c.a)(a,2),o=l[0],s=l[1],i=e.setModal;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"modal-content py-4 text-center px-6"},n.a.createElement("div",{className:"flex justify-between items-center pb-3"},n.a.createElement("p",{className:"text-2xl text-indigo-600 font-bold"},"CREATE A GROUP"),n.a.createElement("div",{onClick:function(e){return i(!1,e)},className:"modal-close cursor-pointer z-50"},n.a.createElement("p",{className:"font-black text-gray-700"},"X"))),n.a.createElement("form",{id:"modal-form"},n.a.createElement("div",{className:"relative w-full mb-3"},n.a.createElement("label",{className:"block uppercase text-gray-700 text-xs font-bold mb-2",htmlFor:"groupname"},"Group Name ",n.a.createElement("span",{className:"text-gray-700 normal-case italic opacity-50"},"(Required)")),n.a.createElement("input",{type:"text",id:"groupname",minLength:"3",maxLength:"40",required:!0,className:"px-3 py-3 placeholder-gray-400 text-gray-700 bg-white rounded text-sm shadow focus:outline-none focus:shadow-outline w-full",placeholder:"Group Name"})),""!==o&&n.a.createElement("div",{className:"bg-red-100 p-3 border-red-600 border rounded"},n.a.createElement("p",{className:"text-red-600 text-center"},o)),n.a.createElement("div",{className:"text-center mt-6"},n.a.createElement("button",{className:"modal-close px-4 bg-indigo-600 p-3 rounded-lg text-white hover:bg-indigo-400",type:"submit",onClick:function(e){if(e.preventDefault(),t)s("Please make a real account to create new groups!");else{var a=document.querySelector("#modal-form").groupname.value,r=h.fromDate(new Date).toDate(),n=null;x.collection("Groups").add({groupMembers:Object(I.a)({},b.currentUser.uid,{color:"green-500",displayName:b.currentUser.displayName,email:b.currentUser.email,role:"creator"}),creator:{name:b.currentUser.displayName,email:b.currentUser.email,id:b.currentUser.uid},createDate:r,demo:!1,lastActivity:r,lastSettled:null,name:a,transactions:null}).then((function(e){n=e.im.path.segments[1],x.collection("GroupsByUser").doc(b.currentUser.uid).set({demo:!1,groups:Object(I.a)({},n,{groupId:n,name:a,creator:b.currentUser.displayName,creatorId:b.currentUser.uid,creatorMail:b.currentUser.email,createDate:h.fromDate(new Date).toDate(),lastActivity:h.fromDate(new Date).toDate()})},{merge:!0})})).then((function(){x.collection("Users").doc(b.currentUser.uid).update({selectedGroup:n})})).then((function(){return i(!1)})).catch((function(e){s(e.message)}))}}},"Create Group")))))},U=n.a.memo((function(e){var t=Object(r.useState)(!1),a=Object(c.a)(t,2),l=a[0],o=a[1],s=e.invite;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"relative flex w-full pt-4 pb-5 md:pb-1 my-2 justify-between bg-white shadow-md flex-shrink flex-wrap rounded mx-1\r hover:bg-indigo-100 hover:shadow-xl border-2 border-transparent hover:border-indigo-200 focus:bg-indigo-100 focus:shadow-xl"},n.a.createElement("div",{className:"inline-block lg:w-1/12 ml-2"},n.a.createElement("span",{className:"cursor-default text-xs md:text-sm text-blue-800 font-bold"},s.inviteDate.toDate().toLocaleDateString()," ")),n.a.createElement("div",{className:"md:inline-block w-full lg:w-8/12 mt-1 text-center text-xs md:text-sm lg:text-xl cursor-default"},n.a.createElement("span",{className:"font-bold text-indigo-800"},"You were invited to join group "),n.a.createElement("span",{className:"font-bold text-green-600"},s.groupName),n.a.createElement("span",{className:"font-bold text-indigo-800"}," by "),n.a.createElement("span",{className:"font-bold text-green-900"},s.creatorName),n.a.createElement("span",{className:"font-bold text-indigo-800"},"!")),n.a.createElement("div",{className:"flex flex-shrink w-full lg:w-2/12 mt-3 lg:mt-0 justify-center"},n.a.createElement("div",{onClick:function(t){return e.acceptInvite(s.groupId,t)},className:"rounded-lg bg-green-200 py-2 px-2 mb-3 hover:bg-green-700 text-green-400 hover:text-white"},n.a.createElement("p",{className:"font-bold text-sm md:text-lg cursor-pointer"},"Accept")),n.a.createElement("div",{onClick:function(){return o(!l)},className:"rounded-lg bg-red-200 py-2 px-2 mb-3 hover:bg-red-700 text-red-400 hover:text-white ml-2"},n.a.createElement("p",{className:"font-bold text-sm md:text-lg cursor-pointer"},"Decline")))),n.a.createElement("div",{className:"flex p-3 w-full md:w-8/12 bg-red-200 text-bold flex-wrap justify-center text-center rounded-lg text-sm md:text-lg "+(l?"":"hidden")+" "},n.a.createElement("h1",{className:"w-full block font-bold text-red-700 mb-4"},"Are you sure you want to delete this invitation to group ",s.groupName,"?"),n.a.createElement("h1",{className:"w-full block font-bold text-red-700 mb-4"},"(This will remove your option to join this group.)"),n.a.createElement("div",{onClick:function(){return o(!1)},className:"inline-block mx-2 w-4/12 bg-red-600 p-2 rounded-lg text-white focus:outline-none cursor-pointer shadow hover:shadow-inner \r border border-transparent hover:border-red-700"},"Cancel"),n.a.createElement("div",{onClick:function(t){return e.deleteInvite(s.groupId,t)},className:"inline-block mx-2 w-4/12 bg-indigo-800 p-2 rounded-lg text-white focus:outline-none cursor-pointer shadow hover:shadow-inner \r border border-transparent hover:border-indigo-900"},"\u2713")))})),F=function(e){var t=e.setModal,a=e.setView,l=Object(r.useContext)(E),o=l.authUser,s=l.demo,i=l.notifications,m=Object(r.useState)(""),d=Object(c.a)(m,2),u=d[0],p=d[1],f=i?i.invites:null,b=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";""!==r&&r.preventDefault(),s?p("These notifications are for demo purposes. Please make a real account to use these features."):(x.collection("Users").doc(o.uid).update({selectedGroup:e}).catch((function(e){console.log(e),p(e.message)})),x.collection("GroupsByUser").doc(o.uid).set({groups:Object(I.a)({},e,{createDate:f[e].createDate,creator:f[e].creatorName,creatorId:f[e].creatorId,creatorMail:f[e].creatorMail,groupId:f[e].groupId,lastActivity:h.fromDate(new Date).toDate(),name:f[e].groupName})},{merge:!0}).then(x.collection("Notifications").doc(o.uid).set({invites:Object(I.a)({},e,w.delete())},{merge:!0})).then((function(){a("MainAppView"),t(!1)})).catch((function(e){console.log(e),p(e.message)})))},g=function(e){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";""!==a&&a.preventDefault(),x.collection("Notifications").doc(o.uid).set({invites:Object(I.a)({},e,w.delete())},{merge:!0}).then((function(){t(!1)})).catch((function(e){console.log(e),p(e.message)}))};return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"modal-content w-full py-4 text-center px-6"},n.a.createElement("div",{className:"flex justify-between items-center pb-3"},n.a.createElement("p",{className:"text-2xl text-indigo-700 font-bold"},"NOTIFICATIONS"),n.a.createElement("div",{onClick:function(e){return t(!1,e)},className:"modal-close cursor-pointer z-50"},n.a.createElement("p",{className:"font-black text-gray-700"},"X"))),n.a.createElement("div",{className:"animated fadeIn w-full mx-auto md:mt-2 flex flex-wrap flex-column items-center justify-center"},f&&Object.keys(f).map((function(e,t){return n.a.createElement(U,{key:f[e].groupId,acceptInvite:b,deleteInvite:g,invite:f[e],userId:o.uid})}))),""!==u&&n.a.createElement("div",{className:"bg-red-100 p-3 border-red-600 border rounded"},n.a.createElement("p",{className:"text-red-600 text-center"},u))))},T=function(){var e=Object(r.useContext)(d),t=e.renderStatus,a=e.setModal,l=e.setView;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"animated fadeIn modal fixed w-full h-full top-0 left-0 flex items-center justify-center"},n.a.createElement("div",{className:"modal-overlay absolute w-full h-full bg-gray-800 opacity-75"}),n.a.createElement("div",{className:"NotificationsModal"===t.modalView?"modal-container bg-gray-100 w-screen md:w-8/12 lg:w-8/12 mx-auto md:mb-32 rounded-md shadow-lg z-50 h-screen md:h-auto overflow-y-auto":"modal-container bg-gray-100 w-screen md:w-8/12 lg:w-6/12 xl:mb-32 mx-auto rounded-md shadow-lg z-50 h-screen md:h-auto overflow-y-auto"},n.a.createElement("div",{onClick:function(e){return a(!1,e)},className:"modal-close absolute top-0 right-0 cursor-pointer flex flex-col items-center mt-4 mr-4 text-white text-sm z-50"},n.a.createElement("svg",{className:"fill-current text-white",xmlns:"http://www.w3.org/2000/svg",width:"18",height:"18",viewBox:"0 0 18 18"},n.a.createElement("path",{d:"M14.53 4.53l-1.06-1.06L9 7.94 4.53 3.47 3.47 4.53 7.94 9l-4.47 4.47 1.06 1.06L9 10.06l4.47 4.47 1.06-1.06L10.06 9z"})),n.a.createElement("span",{className:"text-sm"},"(Esc)")),"AddMemberModal"===t.modalView&&n.a.createElement(A,{setModal:a}),"CreateGroupModal"===t.modalView&&n.a.createElement(G,{setModal:a}),"NotificationsModal"===t.modalView&&n.a.createElement(F,{setModal:a,setView:l}))))},L=function(){var e=Object(r.useContext)(d).setView,t=Object(r.useState)(""),a=Object(c.a)(t,2),l=a[0],o=a[1],s=function(t){t.preventDefault(),o("");var a=D()+"@demo-user.xxx",r=D(),n=D(),l=D(),c=h.fromDate(new Date).toDate();b.createUserWithEmailAndPassword(a,"demopass").then((function(t){var o;t.user&&!0===t.additionalUserInfo.isNewUser&&(x.collection("Users").doc(t.user.uid).set({demo:!0,displayName:"DemoUser",uid:t.user.uid,email:a,selectedGroup:r}),t.user.updateProfile({displayName:"DemoUser"}).then(x.collection("Groups").doc(r).set(function(e,t,a){var r;return{groupMembers:(r={},Object(I.a)(r,e,{color:"green-500",displayName:"DemoUser",email:t,role:"creator"}),Object(I.a)(r,"demo-person-a1",{color:"teal-700",displayName:"Kate",email:"kate@road-acc-demo.xxx",role:"npc"}),Object(I.a)(r,"demo-person-a2",{color:"orange-800",displayName:"Harry",email:"harry@road-acc-demo.xxx",role:"npc"}),Object(I.a)(r,"demo-person-a3",{color:"orange-800",displayName:"Edward",email:"edward@road-acc-demo.xxx",role:"npc"}),r),creator:{name:"DemoUser",email:t,id:e},createDate:a,demo:!0,lastActivity:a,lastSettled:null,name:"Trip to Paris",transactions:Object(I.a)({},a,{amount:120,desc:"Had a nice dinner together!",dividedAmount:30,payers:["demo-person-a3"],spenders:["demo-person-a1","demo-person-a2","demo-person-a3",e],timestamp:a,type:"expense"})}}(b.currentUser.uid,a,c),{merge:!0}).then(x.collection("GroupsByUser").doc(b.currentUser.uid).set({demo:!0,groups:Object(I.a)({},r,{groupId:r,name:"Trip to Paris",creator:"DemoUser",creatorId:b.currentUser.uid,creatorMail:a,createDate:c,lastActivity:c})},{merge:!0})).then(x.collection("Notifications").doc(t.user.uid).set({demo:!0,email:a,displayName:"DemoUser",invites:(o={},Object(I.a)(o,n,{groupName:"Weekend in Milan",creatorName:"Kate",creatorMail:"kate@road-acc-demo.xxx",createDate:c,groupId:n,inviteDate:c}),Object(I.a)(o,l,{groupName:"Camping vacation",creatorName:"Harry",creatorMail:"harry@road-acc-demo.xxx",createDate:c,groupId:l,inviteDate:c}),o)},{merge:!0})).then(e("MainAppView"))))})).catch((function(e){o(e.message)}))};return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"flex content-center items-center justify-center h-full animated fadeIn mb-10"},n.a.createElement("div",{className:"w-full md:w-8/12 lg:w-5/12 xl:w-3/12 px-4 md:pt-32"},n.a.createElement("div",{className:"relative flex flex-col min-w-0 break-words w-full mb-2 shadow-lg rounded-lg border-0"},n.a.createElement("div",{className:"rounded-t mb-0 px-6 py-4"},n.a.createElement("div",{className:"text-center mb-3"},n.a.createElement("small",{className:"text-gray-600 font-bold"},"Log in with")),n.a.createElement("div",{className:"btn-wrapper text-center"},n.a.createElement("button",{className:"bg-white active:bg-gray-100 text-gray-800 font-normal px-4 py-2 rounded outline-none focus:outline-none mr-1 \r uppercase shadow hover:shadow-md inline-flex items-center font-bold text-xs",onClick:function(e){return function(e){e.preventDefault(),o(""),b.signInWithPopup(g).then((function(e){x.collection("Notifications").doc(e.user.uid).set({email:e.user.email,displayName:e.user.displayName},{merge:!0})})).catch((function(e){o(e.message)}))}(e)},type:"button"},n.a.createElement("img",{alt:"...",className:"w-5 mr-1",src:"https://upload.wikimedia.org/wikipedia/commons/5/53/Google_%22G%22_Logo.svg"}),"Google")),n.a.createElement("hr",{className:"mt-6 border-b-1 border-gray-400"})),n.a.createElement("div",{className:"flex-auto px-4 lg:px-10 py-6 pt-0"},n.a.createElement("div",{className:"text-gray-600 text-center mb-3 font-bold"},n.a.createElement("small",null,"Or log in with your email")),n.a.createElement("form",{id:"login-form",onSubmit:function(t){return function(t){t.preventDefault(),o("");var a=document.querySelector("#login-form"),r=a.email.value||"",n=a.password.value||"";b.signInWithEmailAndPassword(r,n).then((function(t){e("MainAppView")}))}(t)}},n.a.createElement("div",{className:"relative w-full mb-3"},n.a.createElement("label",{className:"block uppercase text-gray-700 text-xs font-bold mb-2",htmlFor:"grid-password"},"Email"),n.a.createElement("input",{type:"email",id:"email",className:"px-3 py-3 placeholder-gray-400 text-gray-700 bg-white rounded text-sm shadow focus:outline-none focus:shadow-outline w-full",placeholder:"Email"})),n.a.createElement("div",{className:"relative w-full mb-3"},n.a.createElement("label",{className:"block uppercase text-gray-700 text-xs font-bold mb-2",htmlFor:"grid-password"},"Password"),n.a.createElement("input",{type:"password",id:"password",className:"px-3 py-3 placeholder-gray-400 text-gray-700 bg-white rounded text-sm shadow focus:outline-none focus:shadow-outline w-full",placeholder:"Password"})),""!==l&&n.a.createElement("div",{className:"bg-red-100 p-3 border-red-600 border rounded"},n.a.createElement("p",{className:"text-red-600 text-center"},l)),n.a.createElement("div",{className:"text-center mt-6"},n.a.createElement("button",{className:"bg-purple-600 hover:bg-purple-500 text-white active:bg-gray-700 text-sm font-bold uppercase px-6 py-3 rounded shadow \r hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 w-full",type:"submit"},"Log In"))))),n.a.createElement("div",{className:"flex flex-wrap text-xl mt-6"},n.a.createElement("div",{className:"w-1/2"},n.a.createElement("span",{onClick:function(t){return e("ForgotPassword",t)},className:"text-gray-600 font-bold italic cursor-pointer"},n.a.createElement("small",null,"Forgot password?"))),n.a.createElement("div",{className:"w-1/2 text-right"},n.a.createElement("span",{onClick:function(t){return e("CreateAccount",t)},className:"text-gray-600 font-bold italic cursor-pointer"},n.a.createElement("small",null,"Create new account"))),n.a.createElement("div",{className:"w-full mt-4 text-center text-lg font-bold text-gray-600"}," Or ")),n.a.createElement("div",{className:"flex w-full text-center justify-center"},n.a.createElement("div",{onClick:function(e){s(e)},className:"w-3/6 md:w-8/12 items-center justify-center \r py-3 mt-6 bg-green-500 rounded-lg shadow-lg border-2 border-gray-300 cursor-pointer hover:bg-green-400 hover:shadow-inner"},n.a.createElement("span",{className:"text-white font-fira text-lg text-sm md:text-xl"},"Log in as Demo user"))))))},V=function(){var e=Object(r.useContext)(d).setView,t=Object(r.useState)(""),a=Object(c.a)(t,2),l=a[0],o=a[1];return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"flex content-center items-center justify-center h-full animated fadeIn mb-10"},n.a.createElement("div",{className:"w-full md:w-8/12 lg:w-3/12 px-4 pt-6 md:pt-32"},n.a.createElement("div",{className:"relative flex flex-col min-w-0 break-words w-full mb-6 shadow-lg rounded-lg border-0"},n.a.createElement("div",{className:"flex-auto px-4 lg:px-10 py-10 pt-0"},n.a.createElement("div",{className:"text-gray-600 text-center mb-3 font-bold"},n.a.createElement("small",null,"Create an account")),n.a.createElement("form",{id:"create-account-form",onSubmit:function(e){return function(e){e.preventDefault(),o("");var t=document.querySelector("#create-account-form"),a=t.nickname.value||"",r=t.email.value||"",n=t.password.value||"";b.createUserWithEmailAndPassword(r,n).then((function(e){e.user&&!0===e.additionalUserInfo.isNewUser&&(x.collection("Users").doc(e.user.uid).set({demo:!1,displayName:a,uid:e.user.uid,email:r,selectedGroup:null}),e.user.updateProfile({displayName:a}).then(x.collection("Notifications").doc(e.user.uid).set({demo:!1,email:r,displayName:a,invites:null},{merge:!0})).catch((function(e){o(e.message)})))})).catch((function(e){o(e.message)}))}(e)}},n.a.createElement("div",{className:"relative w-full mb-3"},n.a.createElement("label",{className:"block uppercase text-gray-700 text-xs font-bold mb-2",htmlFor:"nickname"},"Nickname ",n.a.createElement("span",{className:"text-gray-700 normal-case italic opacity-50"},"(Required, max. 12 characters)")),n.a.createElement("input",{type:"text",id:"nickname",maxLength:"12",required:!0,className:"px-3 py-3 placeholder-gray-400 text-gray-700 bg-white rounded text-sm shadow focus:outline-none focus:shadow-outline w-full",placeholder:"Nickname"})),n.a.createElement("div",{className:"relative w-full mb-3"},n.a.createElement("label",{className:"block uppercase text-gray-700 text-xs font-bold mb-2",htmlFor:"email"},"Email ",n.a.createElement("span",{className:"text-gray-700 normal-case italic opacity-50"},"(Required)")),n.a.createElement("input",{type:"email",id:"email",minLength:"4",maxLength:"60",required:!0,className:"px-3 py-3 placeholder-gray-400 text-gray-700 bg-white rounded text-sm shadow focus:outline-none focus:shadow-outline w-full",placeholder:"Email"})),n.a.createElement("div",{className:"relative w-full mb-3"},n.a.createElement("label",{className:"block uppercase text-gray-700 text-xs font-bold mb-2",htmlFor:"password"},"Password ",n.a.createElement("span",{className:"text-gray-700 normal-case italic opacity-50"},"(Required)")),n.a.createElement("input",{type:"password",id:"password",minLength:"6",maxLength:"16",required:!0,className:"px-3 py-3 placeholder-gray-400 text-gray-700 bg-white rounded text-sm shadow focus:outline-none focus:shadow-outline w-full",placeholder:"Password"})),""!==l&&n.a.createElement("div",{className:"bg-red-100 p-3 border-red-600 border rounded"},n.a.createElement("p",{className:"text-red-600 text-center"},l)),n.a.createElement("div",{className:"text-center mt-6"},n.a.createElement("button",{className:"bg-purple-600 hover:bg-purple-500 text-white active:bg-gray-700 text-sm font-bold uppercase px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 w-full",type:"submit"},"Create Account"))))),n.a.createElement("div",{className:"flex flex-wrap text-lg md:text-xl mt-6"},n.a.createElement("div",{className:"w-2/3 md:w-1/2"},n.a.createElement("span",{onClick:function(t){return e("Landing",t)},className:"text-gray-600 font-bold italic cursor-pointer"},n.a.createElement("small",null,"< Back to Login Screen")))))))},P=function(e){var t=e.balance;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"relative flex w-3/4 md:w-3/5 my-2 flex-col items-center flex-shrink mx-1 border-t"},n.a.createElement("div",{className:"flex justify-center bg-indigo-100 w-4/5 mt-2 shadow-md rounded text-center border border-gray-300"},0===t&&n.a.createElement("span",{className:"text-green-600 font-bold text-lg"},t.toFixed(0)),t<0&&n.a.createElement("span",{className:"text-red-600 font-bold text-lg"},t.toFixed(2)),t>0&&n.a.createElement("span",{className:"text-green-600 font-bold text-lg"},"+",t.toFixed(2)))))},R=n.a.memo((function(e){return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"relative flex w-5/12 md:w-1/5 flex-col py-1 md:py-4 md:pb-1 my-2 items-center bg-white shadow-lg rounded flex-shrink mx-1"},"creator"===e.member.role&&n.a.createElement("span",{className:"absolute top-0 left-0 mt-1 ml-2 text-xs md:text-sm text-white md:text-green-600 font-bold"},"Creator"),n.a.createElement("div",{className:"hidden md:block rounded-full h-12 w-12 bg-"+e.member.color+" text-center"},n.a.createElement("h1",{className:"font-bold text-white text-2xl mt-1"},e.member.displayName.slice(0,1).toUpperCase())),n.a.createElement("h1",{"aria-label":e.member.email,"data-balloon-pos":"down",className:"tooltip-grey font-bold text-lg md:text-xl my-auto text-"+e.member.color},e.member.displayName),n.a.createElement(P,{balance:e.balance})))})),q=function(e){var t=e.balances,a=e.groupTotals,l=Object(r.useContext)(N).currentGroup,o=Object(r.useContext)(d).setModal,c=l?l.groupMembers:null;return n.a.createElement(n.a.Fragment,null,n.a.createElement("h4",{className:"animated fadeIn font-bold text-2xl text-center text-indigo-800 font-fira"},l.name),n.a.createElement("h4",{className:"animated fadeIn italic font-bold text-gray-600 text-base text-center mt-4 font-fira"},"Members and their pay balance"),n.a.createElement("div",{className:"animated fadeIn w-full max-w-6xl mx-auto flex flex-wrap flex-column justify-center"},c&&Object.keys(c).map((function(e){return n.a.createElement(R,{key:e,id:e,member:c[e],balance:t?t[e]:0})})),n.a.createElement("div",{onClick:function(e){return o("AddMemberModal",e)},className:"flex cursor-pointer w-5/12 md:w-1/5 flex-col py-2 md:py-4 my-2 \r items-center bg-transparent border-2 border-gray-400 border-dashed rounded flex-shrink mx-1 hover:bg-indigo-200","aria-label":"Add a member","data-balloon-pos":"down",id:"addButton"},n.a.createElement("div",{className:"rounded md:rounded-full w-full h-full md:h-12 md:w-12 bg-purple-100 md:bg-purple-400 text-center"},n.a.createElement("h1",{className:"hidden md:block font-bold text-white text-3xl"},"+"),n.a.createElement("h1",{className:"md:hidden font-bold text-purple-700 text-xl"},"Add Member")),n.a.createElement("h1",{className:"hidden md:inline tooltip-grey font-bold text-gray-600 text-xl md:text-2xl my-auto"},"Click to add"))),n.a.createElement("div",{className:"w-full text-center my-2 pb-2 border-b"},n.a.createElement("div",{className:"w-full"},n.a.createElement("span",{className:"font-bold text-gray-600 text-xl italic"},"Total expenses: Group | Average:",n.a.createElement("span",{className:"text-red-300 not-italic"},a&&"  ".concat(Math.floor(a.everything),"  |  ").concat(Math.floor(a.average)," p.p.")))),n.a.createElement("div",{className:"w-full"},n.a.createElement("span",{className:"font-bold text-gray-600 text-xl italic"},"Total since last settle: Group | Average:",n.a.createElement("span",{className:"text-red-300 not-italic"},a&&"  ".concat(Math.floor(a.everythingAfterSettle)," \n             |  ").concat(Math.floor(a.averageAfterSettle)," p.p."))))))},B=function(e){var t=e.groupId,a=e.groupMembers,l=e.creatorId,o=e.balances,s=Object(r.useContext)(E).authUser,i=Object(r.useState)(!1),m=Object(c.a)(i,2),d=m[0],u=m[1],p=Object(r.useState)(null),f=Object(c.a)(p,2),b=f[0],g=f[1],w=Object(r.useState)(null),v=Object(c.a)(w,2),y=v[0],N=v[1],j=Object(r.useState)(null),k=Object(c.a)(j,2),O=k[0],C=k[1],S=Object(r.useState)(null),M=Object(c.a)(S,2),A=M[0],G=M[1],U="undefined"!==typeof a?a:null,F=s?s.uid:null,T=function(e){var t=function(e){if(!e)throw new Error("Error: Can not find balances in settle calculator!");for(var t,a=[],r=Object.keys(e),n=Object.values(e).reduce((function(e,t){return t+e}))/r.length,l=r.sort((function(t,a){return e[t]-e[a]})),o=l.map((function(t){return e[t]-n})),c=0,s=l.length-1;c<s;)t=Math.min(-o[c],o[s]),o[c]+=t,o[s]-=t,t>.03&&a.push({from:l[c],amount:t,to:l[s]}),0===o[c]&&c++,0===o[s]&&s--;return a}(e);g(t)};return Object(r.useEffect)((function(){o&&T(o)}),[o,a]),n.a.createElement(n.a.Fragment,null,d&&n.a.createElement("div",{className:"relative flex w-11/12 md:w-8/12 flex-wrap justify-center items-center bg-white rounded-lg shadow py-2 text-center text-xl"},n.a.createElement("span",{className:"w-9/12 text-gray-600 font-bold border-b mb-4"},"Transfers to settle and set everyone at 0 debts"),n.a.createElement("div",{onClick:function(e){return u(!1)},className:"absolute top-0 right-0 mb-3 px-3 py-1 bg-red-600 cursor-pointer font-bold text-xl  text-white rounded-lg hover:bg-red-500 shadow border border-gray-200"},"X"),b&&U&&b.map((function(e,t){return n.a.createElement("div",{key:t,className:"w-full text-gray-700 font-bold"},n.a.createElement("span",{className:"text-"+a[e.from].color+" "},a[e.from].displayName),n.a.createElement("span",{className:"text-gray-700"}," sends to "),n.a.createElement("span",{className:"text-"+a[e.to].color+" "},a[e.to].displayName),n.a.createElement("span",{className:"text-gray-700"},": "),n.a.createElement("span",{className:"text-gray-700"},e.amount.toFixed(2)))})),F!==l&&n.a.createElement("span",{className:"w-9/12 text-base italic text-gray-500 font-bold border-t my-6"},"Your group creator can confirm settlement to reset the balances to 0 but keep the group and expense history."),F===l&&n.a.createElement(n.a.Fragment,null,n.a.createElement("span",{className:"w-9/12 text-base italic text-gray-500 font-bold border-t my-6"},"Confirm settlement has been done by members? This will reset the balances to 0 but keep the group and expense history."),n.a.createElement("div",{onClick:function(){return N(!y)},className:"w-4/6 md:w-5/12 text-center py-3 mb-4 bg-green-500 rounded-lg shadow-lg border-2 border-gray-300  cursor-pointer hover:bg-green-400 hover:shadow-inner"},n.a.createElement("span",{className:"text-white text-lg md:text-2xl"},"Confirm Settlement")),y&&n.a.createElement("div",{className:"flex flex-wrap w-full p-3 w-8/12 bg-red-200 text-bold justify-center items-center text-center rounded-lg text-xl"},n.a.createElement("h1",{className:"w-full font-bold text-red-700 text-lg md:text-lg mb-4"},"Are you sure you want to settle and reset?"),n.a.createElement("div",{onClick:function(){return N(!1)},className:"block mx-2 w-5/12 bg-red-600 p-2 rounded-lg text-white focus:outline-none cursor-pointer shadow hover:shadow-inner  border border-transparent hover:border-red-700"},"Cancel"),n.a.createElement("div",{onClick:function(){return function(){var e=D(),a=h.fromDate(new Date).toDate();x.collection("Groups").doc(t).set({lastActivity:a,lastSettled:a,transactions:Object(I.a)({},e,{amount:0,desc:"Group did settlement!",dividedAmount:0,payers:null,spenders:null,timestamp:a,type:"settlement"})},{merge:!0}).then((function(){u(!1),g(null),G("Success! Settled"),console.log("did settle!"),setTimeout((function(){return G("")}),3e3)})).catch((function(e){C(e.message)}))}()},className:"block mx-2 w-2/12 bg-indigo-800 p-2 rounded-lg text-white focus:outline-none cursor-pointer shadow hover:shadow-inner  border border-transparent hover:border-indigo-900"},"\u2713")))),A&&n.a.createElement("div",{id:"settle-success-bar",className:"flex w-full mt-6 h-16 bg-green-100 p-3 border-green-600 border rounded items-center justify-center animated"},n.a.createElement("p",{className:"text-green-600"},A)),O&&n.a.createElement("div",{className:"flex w-full my-4 h-16 bg-red-100 p-3 border-red-600 border rounded items-center justify-center"},n.a.createElement("p",{className:"text-red-600"},O)),n.a.createElement("div",{className:"flex w-full text-center justify-center"},n.a.createElement("div",{onClick:function(e){u(!0)},className:"w-3/6 md:w-3/12 items-center justify-center  py-3 mt-4 bg-green-500 rounded-lg shadow-lg border-2 border-gray-300 cursor-pointer hover:bg-green-400 hover:shadow-inner"},n.a.createElement("span",{className:"text-white font-fira text-lg md:text-xl"},"Settle All Differences"))))},W=function(e){var t=e.memberId,a=e.displayName;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"mx-4 text-lg flex items-center content-center"},n.a.createElement("input",{type:"checkbox",className:"h-6 w-6 spend-checkbox",defaultChecked:!0,value:t,name:"spenders",id:"spender-"+t}),n.a.createElement("label",{className:"ml-2"},a)))},z=function(e){var t=e.memberId,a=e.displayName,r=e.authId;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"mx-4 text-lg flex items-center content-center"},n.a.createElement("input",{type:"radio",value:t,name:"payers",id:"payer-"+t,className:"h-6 w-6 pay-checkbox",defaultChecked:r===t}),n.a.createElement("label",{className:"ml-2"},a)))},H=function(){var e=Object(r.useContext)(E).authUser,t=Object(r.useContext)(N).currentGroup,a=Object(r.useState)(""),l=Object(c.a)(a,2),o=l[0],s=l[1],i=Object(r.useState)(""),m=Object(c.a)(i,2),d=m[0],u=m[1],p=Object(r.useState)(!1),f=Object(c.a)(p,2),b=f[0],g=f[1],w=Object(r.useState)(!1),v=Object(c.a)(w,2),y=v[0],j=v[1],k=Object(r.useState)(""),O=Object(c.a)(k,2),C=O[0],S=O[1],M=Object(r.useState)(""),A=Object(c.a)(M,2),G=A[0],U=A[1],F=t?t.groupMembers:null;return n.a.createElement(n.a.Fragment,null,""!==G&&n.a.createElement("div",{id:"transaction-success-bar",className:"flex w-full mt-6 h-16 bg-green-100 p-3 border-green-600 border rounded items-center justify-center animated"},n.a.createElement("p",{className:"text-green-600"},G)),n.a.createElement("div",{className:(y&&!b?"":"hidden ")+"w-full animated fadeIn slow"},n.a.createElement("div",{className:"w-full flex justify-between items-end"},n.a.createElement("h3",{className:"font-bold font-fira text-lg text-indigo-500 w-2/3"},"Add new group expense"),n.a.createElement("div",{onClick:function(e){return j(!1)},className:"mb-3 px-3 py-1 bg-red-600 cursor-pointer font-bold text-xl  text-white rounded-lg hover:bg-red-500 shadow border border-gray-200"},"X")),""!==C&&n.a.createElement("div",{className:"flex w-full my-4 h-16 bg-red-100 p-3 border-red-600 border rounded items-center justify-center"},n.a.createElement("p",{className:"text-red-600"},C)),n.a.createElement("form",{onSubmit:b?function(){}:function(e){e.preventDefault(),g(!0);var a=[],r=[],n=null,l=D(),c=h.fromDate(new Date).toDate(),i=document.querySelectorAll(".spend-checkbox"),m=document.querySelectorAll(".pay-checkbox");return i.forEach((function(e){e.checked&&a.push(e.value)})),m.forEach((function(e){e.checked&&r.push(e.value)})),""===o||""===d?(S("Please fill in an amount and a description."),g(!1),null):a.length&&r.length?(n=Math.abs(d/a.length).toFixed(2),void x.collection("Groups").doc(t.groupId).set({lastActivity:c,transactions:Object(I.a)({},l,{amount:Math.abs(d).toFixed(2),desc:o,dividedAmount:n,payers:r,spenders:a,timestamp:c,type:"expense"})},{merge:!0}).then((function(){u(""),s(""),g(!1),j(!1),U('Success! Added "'+o+'"'),setTimeout((function(){return U("")}),3e3)})).catch((function(e){S(e.message),g(!1)}))):(S("Please fill in both who paid the expense and who participated."),g(!1),null)},id:"add-form",className:"font-fira"},n.a.createElement("div",{className:"form-control"},n.a.createElement("label",{htmlFor:"amount"},"Amount"),n.a.createElement("input",{type:"number",min:"0",step:"0.01",value:d,onChange:function(e){return u(e.target.value)},placeholder:"Number amount...",required:!0,max:"999999"})),n.a.createElement("div",{className:"form-control"},n.a.createElement("label",{htmlFor:"text"},"Description of expense"),n.a.createElement("input",{type:"text",value:o,onChange:function(e){return s(e.target.value)},placeholder:"Text description here...",required:!0,minLength:"3",maxLength:"150"})),n.a.createElement("h1",{className:"mt-6 italic text-center"},"Who participated in this expense? Check name(s), expense will be split among those"),n.a.createElement("div",{className:"flex items-center content-center flex-wrap mb-4 justify-center"},F&&Object.keys(F).map((function(e){return n.a.createElement(W,{key:e,memberId:e,displayName:F[e].displayName})}))),n.a.createElement("h1",{className:"mt-3 italic text-center"},"Who paid for it this time?"),n.a.createElement("div",{className:"flex items-center content-center flex-wrap mb-8 justify-center"},F&&Object.keys(F).map((function(t){return n.a.createElement(z,{key:t,memberId:t,displayName:F[t].displayName,authId:e.uid})}))),""!==C&&n.a.createElement("div",{className:"flex w-full my-4 h-16 bg-red-100 p-3 border-red-600 border rounded mt-2  items-center justify-center"},n.a.createElement("p",{className:"text-red-600"},C)),n.a.createElement("button",{type:"submit",className:"block mx-auto mt-4 w-1/2 px-4 bg-indigo-700 p-3 rounded-lg text-white hover:bg-indigo-600 focus:outline-none shadow border border-gray-200"},"Add it!"))),n.a.createElement("div",{className:"w-full font-fira"},y?null:n.a.createElement("button",{onClick:function(e){e.preventDefault(),j(!0)},className:"block mx-auto mt-8 mb-3 w-1/2 px-4 bg-indigo-700 p-3 rounded-lg text-white hover:bg-indigo-600 focus:outline-none shadow border border-gray-200"},"Add Expense")))},X=function(e){var t=e.transaction,a=e.id,l=e.deleteTransaction,o=e.members,s=e.creatorId,i=e.authId,m=(e.timestamp,Object(r.useState)(!1)),d=Object(c.a)(m,2),u=d[0],p=d[1],f=t.timestamp.toDate().toLocaleDateString(),b=Object.keys(o).length||0,g=parseFloat(t.amount),x=Number.isInteger(g)?parseInt(g):g.toFixed(2),h=!!i&&s===i,w=[],v={},E=!(!t||"settlement"!==t.type);t&&"undefined"!==typeof t.spenders&&t.spenders&&t.spenders.map((function(e){return w.push(o[e].displayName||"Unknown")}));var y=w.join(", ");return t&&"undefined"!==typeof t.payers&&t.payers&&t.payers.forEach((function(e){v.displayName=o[e].displayName||"Unknown",v.color=o[e].color||"gray-800"})),n.a.createElement(n.a.Fragment,null,n.a.createElement("li",{className:"relative rounded-sm flex w-full flex-wrap justify-between items-center p-2 my-2 bg-white shadow text-gray-800 border-l-4 border-r-4 border-red-300 "+(u&&" bg-red-100 shadow-inner ")+(E&&" bg-green-300 border-green-500 ")},n.a.createElement("div",{className:"flex justify-left w-full lg:w-2/4 items-center"},"expense"===t.type&&n.a.createElement("span",{className:"text-red-600 w-3/12 lg:w-2/12 p-2 bg-red-100 rounded-lg"},x),n.a.createElement("span",{className:"w-10/12 ml-2"},t.desc)),n.a.createElement("div",{className:"flex flex-wrap justify-center my-3 lg:my-0 lg:justify-end text-center lg:text-right w-full lg:w-2/4 items-center"},n.a.createElement("div",{className:"w-full lg:w-11/12"},n.a.createElement("span",{className:"ml-1 italic"},w.length===b?"Group":y),n.a.createElement("span",{className:"ml-1 text-gray-600"},"| ",f," |"),n.a.createElement("span",{className:"text-"+v.color+" ml-1 text-center"},v.displayName),!E&&n.a.createElement("img",{className:"hidden lg:inline mr-1",width:"32",height:"32",src:"img/wallet-icon.png",alt:"Wallet Icon"})),h&&n.a.createElement("span",{onClick:function(){return p(!0)},className:"w-1/3 md:w-1/5 lg:w-1/12 cursor-pointer bg-red-500 text-white text-center  text-lg font-bold rounded p-2 mt-2 lg:mt-0 hover:bg-red-400"},"X"))),n.a.createElement("div",{className:"flex flex-wrap w-full p-3 w-8/12 bg-red-200 text-bold justify-center items-center text-center rounded-lg text-xl "+(u?"":"hidden")+" "},n.a.createElement("h1",{className:"w-full font-bold text-red-700 text-lg md:text-lg mb-4"},"Are you sure you want to delete this expense? (",t.amount,")"),n.a.createElement("div",{onClick:function(){return p(!1)},className:"block mx-2 w-5/12 bg-red-600 p-2 rounded-lg text-white focus:outline-none cursor-pointer shadow hover:shadow-inner  border border-transparent hover:border-red-700"},"Cancel"),n.a.createElement("div",{onClick:function(){return l(a)},className:"block mx-2 w-2/12 bg-indigo-800 p-2 rounded-lg text-white focus:outline-none cursor-pointer shadow hover:shadow-inner  border border-transparent hover:border-indigo-900"},"\u2713")))},_=function(){var e=Object(r.useContext)(N).currentGroup,t=Object(r.useContext)(E).authUser,a=e.groupMembers||null,l=e.creator.id,o=e.transactions||null,c=[];o&&Object.keys(o).map((function(e){return c.push(Object(s.a)({},o[e],{id:e}))}));var i=c.length?c.sort((function(e,t){return t.timestamp.seconds-e.timestamp.seconds})):[],m=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";""!==a&&a.preventDefault(),x.collection("Groups").doc(e.groupId).set({transactions:Object(I.a)({},t,w.delete())},{merge:!0}).catch((function(e){console.log(e)}))};return n.a.createElement("div",{className:"w-screen mb-12 pb-4 px-1 font-fira overflow-x-hidden overflow-y-auto scrollable border-b border-gray-400",id:"transactionlist"},n.a.createElement("h3",{className:"border-b border-gray-400 mb-4"},"History"),n.a.createElement("ul",{className:"list-none w-full"},i.length?i.map((function(e){return n.a.createElement(X,{key:e.id,id:e.id,transaction:e,timestamp:e.timestamp,members:a,creatorId:l,authId:t.uid,deleteTransaction:m})})):n.a.createElement("li",{className:"p-2 my-2 bg-white shadow-md text-gray-800"},"No Transactions yet!")))},Y=function(){var e=Object(r.useContext)(N).currentGroup,t=e?e.groupId:null,a=e?e.groupMembers:null,l=e?e.creator.id:null,o=e?e.transactions:null,s=e?e.lastSettled:null,i=Object(r.useState)(null),m=Object(c.a)(i,2),d=m[0],u=m[1],p=Object(r.useState)(null),f=Object(c.a)(p,2),b=f[0],g=f[1];return Object(r.useEffect)((function(){a&&function(e,t,a){if(e&&t){var r=Object.keys(t).length-1;if("settlement"===Object.values(t)[r].type)u(null);else{var n=Object.keys(e).length,l={},c={};Object.keys(e).forEach((function(e){l[e]=0,c[e]=[]}));var s={everything:0,average:0,everythingAfterSettle:0,averageAfterSettle:0};null!==t&&"undefined"!==typeof t&&Object.keys(t).forEach((function(e){var t=o[e];if(s.everything+=Math.abs(-t.amount),s.average+=t.amount/n,t.timestamp>a){s.everythingAfterSettle+=Math.abs(-t.amount),s.averageAfterSettle+=t.amount/n;var r="undefined"!==typeof t.spenders?t.spenders:null,l="undefined"!==typeof t.payers?t.payers:null;r&&r.forEach((function(e){c[e].push(-t.dividedAmount)})),l&&l.forEach((function(e){c[e].push(+t.amount)}))}})),Object.keys(c).forEach((function(e){var t=c[e].reduce((function(e,t){return e+t}),0);l[e]=t})),g(s),u(l)}}else u(null)}(e.groupMembers,o,s)}),[o,a]),n.a.createElement(n.a.Fragment,null,e&&n.a.createElement(q,{balances:d,groupTotals:b}),n.a.createElement("div",{className:"animated fadeIn w-11/12 md:w-9/12 lg:w-6/12 mx-auto flex flex-wrap flex-column content-center justify-center"},e&&n.a.createElement(B,{balances:d,groupId:t,groupMembers:a,creatorId:l}),e&&n.a.createElement(H,null),e&&n.a.createElement(_,null)))},K=n.a.memo((function(e){var t=Object(r.useState)(!1),a=Object(c.a)(t,2),l=a[0],o=a[1],s=e.group,i=e.userId||null,m=!!i&&s.creatorId===i;return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"relative flex w-full pt-4 pb-5 md:pb-1 my-2 justify-between bg-white shadow-md rounded flex-shrink mx-1\r hover:bg-indigo-100 hover:shadow-xl border-2 border-transparent hover:border-indigo-200 focus:bg-indigo-100 focus:shadow-xl"},n.a.createElement("div",{className:"absolute top-0 mx-auto h-full w-1/5"},n.a.createElement("span",{onClick:function(t){return e.selectGroup(s.groupId,t)},className:"block cursor-pointer text-xs md:text-sm text-green-600 font-bold"},"Creator: ",s.creatorId===i?"You":s.creator," "),n.a.createElement("span",{onClick:function(t){return e.selectGroup(s.groupId,t)},className:"block cursor-pointer text-xs text-blue-800 font-bold"},"Created on: "),n.a.createElement("span",{onClick:function(t){return e.selectGroup(s.groupId,t)},className:"block cursor-pointer text-xs text-blue-800 font-bold"},s.createDate.toDate().toLocaleDateString()," ")),n.a.createElement("div",{onClick:function(t){return e.selectGroup(s.groupId,t)},className:"mx-auto w-4/5 h-12 text-center cursor-pointer"},n.a.createElement("p",{className:"font-bold text-indigo-800 text-sm md:text-xl"},s.name)),m&&n.a.createElement("div",{onClick:function(){return o(!l)},className:"absolute right-0 bottom-0 mr-2 mb-6 md:mb-3 rounded-lg bg-red-200 py-2 px-2 mb-3 hover:bg-red-700 text-red-400 hover:text-white"},n.a.createElement("p",{className:"font-bold text-sm md:text-lg cursor-pointer"},"Delete"))),n.a.createElement("div",{className:"flex flex-column h-auto p-3 w-11/12 bg-red-200 text-bold flex-wrap justify-center text-center rounded-lg text-xl "+(l?"":"hidden")+" "},n.a.createElement("h1",{className:"w-full block font-bold text-red-700 text-lg md:text-lg mb-4"},"Are you sure you want to delete group: ",s.name,"?"),n.a.createElement("h1",{className:"w-full block font-bold text-red-700 text-lg md:text-lg mb-4"},"(Warning: This deletes it for all group members)"),n.a.createElement("div",{onClick:function(){return o(!1)},className:"block mx-2 w-5/12 bg-red-600 p-2 rounded-lg text-white focus:outline-none cursor-pointer shadow hover:shadow-inner \r border border-transparent hover:border-red-700"},"Cancel"),n.a.createElement("div",{onClick:function(t){return e.deleteGroup(s.groupId,t)},className:"block mx-2 w-2/12 bg-indigo-800 p-2 rounded-lg text-white focus:outline-none cursor-pointer shadow hover:shadow-inner \r border border-transparent hover:border-indigo-900"},"\u2713")))})),J=function(){var e=Object(r.useContext)(E).authUser,t=Object(r.useState)(null),a=Object(c.a)(t,2),l=a[0],o=a[1],s=Object(r.useState)(!0),i=Object(c.a)(s,2),m=i[0],u=i[1],p=Object(r.useContext)(d),f=p.setView,b=p.setModal,g=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";""!==a&&a.preventDefault(),e.selectedGroup!==t&&x.collection("Users").doc(e.uid).update({selectedGroup:t}).catch((function(e){console.log(e)})),f("MainAppView")},h=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";""!==a&&a.preventDefault(),t===e.selectedGroup&&x.collection("Users").doc(e.uid).update({selectedGroup:null}).catch((function(e){console.log(e)})),x.collection("Groups").doc(t).delete().then((function(){x.collection("GroupsByUser").doc(e.uid).set({groups:Object(I.a)({},t,w.delete())},{merge:!0}),o(l.filter((function(e){return e.groupId!==t})))})).catch((function(e){console.log(e)}))};return Object(r.useEffect)((function(){e&&function(e){if(e){var t=[],a=[];x.collection("GroupsByUser").doc(e.uid).get().then((function(e){var r=e.data()?e.data().groups:null;r&&(Object.keys(r).map((function(e){return t.push(r[e]),a.push([e])})),t.sort((function(e,t){return t.createDate-e.createDate}))),t.length>=1?o(t):o(null),u(!1)})).catch((function(e){console.log(e)}))}}(e)}),[]),m?n.a.createElement(v,null):n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"animated fadeIn w-11/12 md:w-8/12 lg:w-4/12 mx-auto mt-8 flex flex-wrap flex-column content-center justify-center"},n.a.createElement("h1",{className:"text-center block w-full text-bold text-indigo-800 text-2xl"},l?"Your Groups":"No Groups yet. Create one first!"),n.a.createElement("div",{className:"relative flex w-8/12 pt-4 pb-5 md:pb-1 my-4 items-center bg-indigo-800 shadow-lg rounded-lg flex-shrink mx-1"},n.a.createElement("div",{onClick:function(e){return b("CreateGroupModal",e)},className:"block h-12 w-full text-center cursor-pointer"},n.a.createElement("h1",{className:"font-bold text-white text-sm md:text-xl mt-1 shadow-lg"},"CREATE NEW GROUP"))),l&&l.map((function(t){return n.a.createElement(K,{key:t.groupId,selectGroup:g,deleteGroup:h,group:t,userId:e.uid})}))))},Q=function(){var e=Object(r.useContext)(d).setView,t=Object(r.useState)(""),a=Object(c.a)(t,2),l=a[0],o=a[1],s=Object(r.useState)(null),i=Object(c.a)(s,2),m=i[0],u=i[1];return n.a.createElement(n.a.Fragment,null,n.a.createElement("div",{className:"flex content-center items-center justify-center h-full animated fadeIn mb-10"},n.a.createElement("div",{className:"w-full md:w-8/12 lg:w-3/12 px-4 pt-6 md:pt-32"},n.a.createElement("div",{className:"relative flex flex-col min-w-0 break-words w-full mb-6 shadow-lg rounded-lg border-0"},n.a.createElement("div",{className:"flex-auto px-4 lg:px-10 py-10 pt-0"},n.a.createElement("div",{className:"text-gray-600 text-center mb-3 font-bold"},n.a.createElement("small",null,"Send yourself a mail with a new password")),n.a.createElement("form",{id:"password-reset-form",onSubmit:function(e){return function(e){e.preventDefault(),o("");var t=document.querySelector("#password-reset-form").email.value||"";b.sendPasswordResetEmail(t).then((function(e){u("Password reset email sent! Please check your mailbox.")})).catch((function(e){o(e.message)}))}(e)}},n.a.createElement("div",{className:"relative w-full mb-3"},n.a.createElement("label",{className:"block uppercase text-gray-700 text-xs font-bold mb-2",htmlFor:"email"},"Email"),n.a.createElement("input",{type:"email",id:"email",minLength:"4",maxLength:"60",required:!0,className:"px-3 py-3 placeholder-gray-400 text-gray-700 bg-white rounded text-sm shadow focus:outline-none focus:shadow-outline w-full",placeholder:"Email"})),m&&n.a.createElement("div",{className:"bg-green-100 p-3 border-green-600 border rounded"},n.a.createElement("p",{className:"text-green-600 text-center"},m)),""!==l&&n.a.createElement("div",{className:"bg-red-100 p-3 border-red-600 border rounded"},n.a.createElement("p",{className:"text-red-600 text-center"},l)),n.a.createElement("div",{className:"text-center mt-6"},n.a.createElement("button",{className:"bg-purple-600 hover:bg-purple-500 text-white active:bg-gray-700 text-sm font-bold uppercase px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 w-full",type:"submit"},"Send password verification email"))))),n.a.createElement("div",{className:"flex flex-wrap text-lg md:text-xl mt-6"},n.a.createElement("div",{className:"w-2/3 md:w-1/2"},n.a.createElement("span",{onClick:function(t){return e("Landing",t)},className:"text-gray-600 font-bold italic cursor-pointer"},n.a.createElement("small",null,"< Back to Login Screen")))))))};var Z=function(){var e=Object(r.useContext)(d).renderStatus,t=function(e){switch(e){case"Landing":return L;case"CreateAccount":return V;case"MainAppView":return Y;case"GroupSelect":return J;case"ForgotPassword":return Q;default:return"none"}}(e.currentView);return n.a.createElement(n.a.Fragment,null,n.a.createElement(y,null,n.a.createElement(j,null,n.a.createElement("img",{src:"./img/car-driving.png",alt:"car-driving",className:"w-1/6 hidden md:block absolute left-0 bottom-0 ml-8 mb-12 -z-10 "}),n.a.createElement(S,null),n.a.createElement(t,null),!1!==e.modalView&&n.a.createElement(T,null))))};o.a.render(n.a.createElement(u,null,n.a.createElement(Z,null)),document.getElementById("root"))}},[[13,1,2]]]);
//# sourceMappingURL=main.88e9629d.chunk.js.map